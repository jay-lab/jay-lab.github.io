---
layout: single
title: "[AWS] 보안그룹(Security Group) 정리"
categories: [AWS]
tag: [Security Group, SG, TIL]
#toc: true
#toc_label: "Contents" # toc 제목
#toc_icon: "cog" # toc 아이콘(톱니바퀴)
author_profile: false

sidebar:
    nav: "docs"
---



**보안그룹에 대하여** (stateful)
{: .notice--info}



## 보안그룹

- stateful

![AWS 보안 그룹의 모든 것 정리합니다(11)](../../images/2022-12-11-Security_Group/AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(11).jpg)



## NACL(Network Access Control List)

- stateless

![AWS 보안 그룹의 모든 것 정리합니다(12)](../../images/2022-12-11-Security_Group/AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(12).jpg)



↓ 도식화했을 때

![AWS 보안 그룹의 모든 것 정리합니다(13)](../../images/2022-12-11-Security_Group/AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(13).jpg)

★ 이처럼, NACL은 서브넷 단위이고 보안그룹은 인스턴스 단위!

![ AWS 보안 그룹의 모든 것 정리합니다(0)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(0).jpg)

![ AWS 보안 그룹의 모든 것 정리합니다(1)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(1).jpg)

![ AWS 보안 그룹의 모든 것 정리합니다(2)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(2).jpg)

![ AWS 보안 그룹의 모든 것 정리합니다(3)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(3).jpg)

![ AWS 보안 그룹의 모든 것 정리합니다(4)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(4).jpg)

![ AWS 보안 그룹의 모든 것 정리합니다(5)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(5).jpg)

SeG-RDS 인바운드 규칙을 10.1.1.1, 10.1.1.2 이런식으로 해놓기에는 다음과 같은 어려움이 있다.

해당 EC2들은 오토스케일링에 의해 생겼다 사라졌다를 반복할 수 있으며 그에따라 IP가 변할 수 있다.

따라서 이러한 유동성에 대응하기 위해 오토스케일링을 하나의 그룹으로 묶어줄 필요가 있는데 그 울타리가 바로 '보안그룹' (여기서는 SeG-EC2 라는 이름의 보안그룹)

따라서 RDS의 인바운드 허용 범위를 특정 IP가 아닌 SeG-EC2 라는 이름의 보안그룹으로 설정하였다.

![ AWS 보안 그룹의 모든 것 정리합니다(6)](../../images/2022-12-11-Security_Group/%20AWS%20%E1%84%87%E1%85%A9%E1%84%8B%E1%85%A1%E1%86%AB%20%E1%84%80%E1%85%B3%E1%84%85%E1%85%AE%E1%86%B8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(6).jpg)

---

# NACL

![ AWS NACL네트워크 액세스 제어 목록의 모든 것 정리합니다(0)](../../images/2022-12-11-Security_Group/%20AWS%20NACL%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%20%E1%84%86%E1%85%A9%E1%86%A8%E1%84%85%E1%85%A9%E1%86%A8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(0).jpg)

![ AWS NACL네트워크 액세스 제어 목록의 모든 것 정리합니다(1)](../../images/2022-12-11-Security_Group/%20AWS%20NACL%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%20%E1%84%86%E1%85%A9%E1%86%A8%E1%84%85%E1%85%A9%E1%86%A8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(1).jpg)

위와같은 고려사항 때문에 웬만하면 NACL보다는 보안그룹으로 컨트롤하는 것을 권장

![ AWS NACL네트워크 액세스 제어 목록의 모든 것 정리합니다(2)](../../images/2022-12-11-Security_Group/%20AWS%20NACL%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%89%E1%85%A6%E1%84%89%E1%85%B3%20%E1%84%8C%E1%85%A6%E1%84%8B%E1%85%A5%20%E1%84%86%E1%85%A9%E1%86%A8%E1%84%85%E1%85%A9%E1%86%A8%E1%84%8B%E1%85%B4%20%E1%84%86%E1%85%A9%E1%84%83%E1%85%B3%E1%86%AB%20%E1%84%80%E1%85%A5%E1%86%BA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%86%B8%E1%84%82%E1%85%B5%E1%84%83%E1%85%A1(2).jpg)

외부에서 80포트로 NACL을 거쳐 ec2로 요청을 했을때, ec2는 db와 통신하기 위해 다시 nacl을 거쳐 db로 요청을 하고, 응답값을 다시 nacl을 거쳐 가져오는 흐름. 따라서, 이 또한 마찬가지로 고려사항, 관리포인트가 증가한다는 점에서 보안그룹으로 해결하는 것을 권장하고있다.