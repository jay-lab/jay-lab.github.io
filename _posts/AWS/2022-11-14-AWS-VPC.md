---
layout: single
title: "[AWS] VPC, Bastion Host와 NAT Gateway"
categories: [AWS]
tag: [VPC, TIL]
#toc: true
#toc_label: "Contents" # toc 제목
#toc_icon: "cog" # toc 아이콘(톱니바퀴)
author_profile: false
sidebar:
    nav: "docs"
---



**AWS VPC, Bastion Host와 NAT Gateway** 
{: .notice--info}



## VPC 구성도

(※ 기초적인 구성도)

![youtu.be-lqnncuQgz28](../../images/2022-11-14-AWS-VPC/youtu.be-lqnncuQgz28.jpg)

내부에서만 서비스하면 되는 데이터베이스 같은 것들은 통상적으로 Private subnet에 위치시킨다.  
다만, 인터넷이 연결되어있지 않기 때문에 Bastion Host, NAT Gateway를 사용.

- 데이터베이스 업데이트
- 데이터 조작
- 패치 진행 등



![youtu.be-lqnncuQgz28 (1)](../../images/2022-11-14-AWS-VPC/youtu.be-lqnncuQgz28%20(1).jpg)

Bastion Host, NAT Gateway는 일종의 '프라이빗 서브넷 내에 있는 EC2가 외부와 통신하기위해 사용되는 대변인' 같은 개념

NAT Instance는 EC2와 같은 서버라서 꺼지면 죽어버리고, 서버 타입(크기)에 따라 최대 트래픽 처리량이 결정되는데,

NAT Gateway는 서비스이기 때문에 서비스가 중단될 일이 없으며, 고가용성(5G~45G/s 범위의 유연함)



### 실습 순서

1. VPC 생성 10.0.0.0/16
    라우팅테이블, Network ACL, SG이 기본적으로 같이 생성됨
2. 서브넷 생성 2EA
   두개의 가용영역에 **퍼블릭 서브넷, 프라이빗 서브넷** 생성
3. 인터넷 게이트웨이 생성
   VPC에 붙여주기(인터넷 게이트웨이는 VPC하나에만 연결할 수 있음)
4. 라우팅테이블 작업
   1. Default 라우팅 테이블 :  
      VPC를 생성할 때 기본적으로 생성된 Default 라우팅 테이블을 클릭해보면  
      '라우팅' 속성에 10.0.0.0/16 범위를 가지고있음.   
      이 라우팅테이블을 퍼블릭 용도의 라우팅테이블로 정하고, 이름에 Public이 들어가도록 지정
   2. 프라이빗 라우팅테이블 생성 10.0.0.1/16